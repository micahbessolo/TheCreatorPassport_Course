<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <title>Course</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.typekit.net/djz3fym.css">
    <link rel="stylesheet" href="assets/CSS/library.css">
</head>
<body>
	<div id="wrapper"  style="z-index: 1; position: relative;"">
		<!--Sidebar-->
		<nav role='navigation'>
			<div class="topNav">
				<a href="/">
					<img class="logo" src="https://i.imgur.com/hTKJ0wx.jpg" alt="logo">
				</a>
			</div>
			<div id="menuToggle">
				<input id="sidebarToggle" type="checkbox" />
				<span onclick="toggleSidebar();"></span>
				<span onclick="toggleSidebar();"></span>
				<span onclick="toggleSidebar();"></span>
				<ul id="menu" class="shadow-sm">
					<a href="/">
						<li class="library"><u>Library</u></li>
					</a>
					<a href="#">
						<li>Profile</li>
					</a>
					<a href="#">
						<li>
							<form action="/logout?_method=DELETE" method="POST" onsubmit="updateRememberMe();">
								<button type="submit" style="all:unset">Log Out</button>
							</form>
						</li>
					</a>
				</ul>
			</div>
		</nav>

		<div style="width: 100vw; height: 520px; background-image: url('https://theloverspassport.com/wp-content/uploads/2021/07/Garmont-Carousel-2-scaled.jpg'); background-repeat: no-repeat;background-size: cover;">
			<div style="display: flex; justify-content: center; top: 30px; position: relative;">
				<div>
					<h1>Welcome <%= name %></h1>
					<div id="resumeVideo" style="display: none;"><%= videoState %></div>
				</div>
			</div>
        </div>
		<div>
			<div style="display: flex; justify-content: center; padding-top: 20px;">
				<div>
					<h2 style="text-decoration: underline; text-underline-offset: 1.0rem;">My Courses</h2>
				</div>
			</div>
			<div style="display: flex; justify-content: center; padding-top: 20px; padding-bottom: 20px;">
				<img decoding="async" src="https://theloverspassport.com/wp-content/uploads/2020/01/DSC2491-scaled.jpg" alt="Stephen &amp; Giselle backpacking the Sierra High Route" itemprop="image" height="400" width="320" style="padding-right: 20px;"  />
				<div style="width: 512px; max-height: 400px; display: flex; flex-direction: column; justify-content: space-between;">
					<div>
						<h3>The Creator Passport Course</h3>
					</div>
					<div class="description">
						Lorem ipsum dolor sit amet, consectetur adipiscing elit, 
						sed do eiusmod tempor incididunt ut labore et dolore magna 
						aliqua. Proin nibh nisl condimentum id venenatis a. 
						Lacinia at quis risus sed vulputate odio ut.
					</div>
					<div>
						<div>480 Lessons · 8.5 Hours · Beginner / Intermediate</div>
						<progress id="progress-bar" max="100" value="70">
						</progress>
						<div id="progress-percentage">70% complete</div>
					</div>
					<div>
						<a id="resumeVideoButton" class="btn" style="background-color: #649399; color: #FFFFFF; width: 179px; height: 50px; font-size: 1.2rem;">Access Course</a>
					</div>
				</div>
			</div>
		</div>
		
    </div>

</body>
</html>

<script type="text/javascript">
	function toggleSidebar()
	{
		document.getElementById("sidebarToggle").click();
	}

	function resumeVideoLink()
	{
		const videoData = document.getElementById("resumeVideo").innerText;

		if (videoData !== '')
		{
			const section = videoData.split('-')[0];
			const time = videoData.split('-')[1];
			const duration = videoData.split('-')[2];

			const goToCourseLink = document.getElementById("resumeVideoButton");
			goToCourseLink.href = '/course?video=' + section + "&resumeTime=" + time + "&duration=" + duration;
		}
		else
		{
			// if variable is not defined, starts user on the first video
			goToCourseLink.href = '1.1_Introduction_to_Photography_Basics.mov-0-57.80775';
		}
		console.log(videoData)
	}
	resumeVideoLink();

	function progressBar()
	{
		const videoData = document.getElementById("resumeVideo").innerText;
		let percentageCompleted = 0;

		if (videoData !== '')
		{		
			// gets the specific section number (i.e 2.5 which is section 2 episode 5)
			const sectionNumber = videoData.split('-')[0].split('_')[0];
			const totalVideos = 480;
			let videoNumber = 0;

			if (sectionNumber.split('.')[0] == 1)
			{
				videoNumber = sectionNumber.split('.')[1];
			}
			else if (sectionNumber.split('.')[0] == 2)
			{
				videoNumber = (sectionNumber.split('.')[1] + 14);
			}
			else if (sectionNumber.split('.')[0] == 3)
			{
				videoNumber = (sectionNumber.split('.')[1] + 31);
			}
			else if (sectionNumber.split('.')[0] == 4)
			{
				
			}
			else if (sectionNumber.split('.')[0] == 5)
			{
				
			}

			percentageCompleted = Math.round((videoNumber/totalVideos) * 100);
			console.log(percentageCompleted);
			document.getElementById('progress-bar').value = percentageCompleted;
			document.getElementById('progress-percentage').innerText = percentageCompleted + "% complete"
		}
		else
		{
			// if variable is not defined, progress bar is 0%
			document.getElementById('progress-bar').value = 0;
			document.getElementById('progress-percentage').innerText = "0% complete"
		}
	}
	progressBar();


</script>